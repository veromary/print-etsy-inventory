<!doctype html>
<html>
<head>

<meta charset="utf-8">
<title>
Etsy Inventory Idea
</title>
<script>

// Check for the various File API support.
if (window.File && window.FileReader && window.FileList && window.Blob) {
  // Great success! All the File APIs are supported.
} else {
  alert('The File APIs are not fully supported in this browser.');
}

</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
  <script src="js/jquery.csv.min.js"></script>
<link href='https://fonts.googleapis.com/css?family=Merienda+One|Lato:400,700' rel='stylesheet' type='text/css'>
<style>
h1, h2 {
   font-family: 'Merienda One', cursive;
}
body {
   font-family: 'Lato', sans-serif;
}
.item {
    border: 1px #000000 solid;
    width: 290px;
    display: inline-block;
    margin-right: 13px;
}
.description {
   text-size: 10pt;
   width: 170px;
   display: inline-block;
}
img {
    width: auto;
  max-width: 110px;
  height: auto;
  max-height: 110px;
  text-align: right;
}
</style>
</head>
<body>

<a href="https://github.com/veromary/print-etsy-inventory/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>

<h1>Print Etsy Inventory</h1>

  <div id="inputs" class="clearfix">
To download your Active Etsy Listings, got to your <strong>Shop Menu > "Shop Settings" > "Options" > "Download Data"</strong> and click the <strong>"Download CSV"</strong> button for your Currently for Sale Listings.  For me it saves as <tt>EtsyListingsDownload.csv</tt>.  Now select that file here:
    <input type="file" id="files" name="files[]" multiple />
Then use your browser to Print (usually Ctrl-P)
  </div>
  <hr />
  <output id="list">
  </output>
  <hr />
  <div id="listings">
  </div>

<script>
    $(document).ready(function() {
      if(isAPIAvailable()) {
        $('#files').bind('change', handleFileSelect);
      }
    });

    function isAPIAvailable() {
      // Check for the various File API support.
      if (window.File && window.FileReader && window.FileList && window.Blob) {
        // Great success! All the File APIs are supported.
        return true;
      } else {
        // source: File API availability - http://caniuse.com/#feat=fileapi
        // source: <output> availability - http://html5doctor.com/the-output-element/
        document.writeln('The HTML5 APIs used in this form are only available in the following browsers:<br />');
        // 6.0 File API & 13.0 <output>
        document.writeln(' - Google Chrome: 13.0 or later<br />');
        // 3.6 File API & 6.0 <output>
        document.writeln(' - Mozilla Firefox: 6.0 or later<br />');
        // 10.0 File API & 10.0 <output>
        document.writeln(' - Internet Explorer: Not supported (partial support expected in 10.0)<br />');
        // ? File API & 5.1 <output>
        document.writeln(' - Safari: Not supported<br />');
        // ? File API & 9.2 <output>
        document.writeln(' - Opera: Not supported');
        return false;
      }
    }

    function handleFileSelect(evt) {
      var files = evt.target.files; // FileList object
      var file = files[0];

      // read the file metadata
      var output = ''
          output += '<span style="font-weight:bold;">' + escape(file.name) + '</span><br />\n';
          output += ' - FileType: ' + (file.type || 'n/a') + '<br />\n';
          output += ' - FileSize: ' + file.size + ' bytes<br />\n';
          output += ' - LastModified: ' + (file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() : 'n/a') + '<br />\n';

      // read the file contents
      printDivs(file);

      // post the results
      $('#list').append(output);
    }

   function printDivs(file) {
      var reader = new FileReader();
      reader.readAsText(file);
      reader.onload = function(event){
         var csv = event.target.result;
         var data = $.csv.toArrays(csv);
         console.log("preshift" + data);
         var html = '';
         data.shift();
         console.log("postshift" + data);
         for(var row in data){
            html += '<div class="item"><div class="description">\r\n' + data[row][0] + '</div>\r\n<img src=\"' + data[row][7] + '\"> </div>\r\n';
         }
     $('#listings').html(html);
     };
      reader.onerror = function(){ alert('Unable to read ' + file.fileName); };
     }
  </script>

<footer>
Print Etsy Inventory is a project of the Brandt Lab: <a href="http://www.brandt.id.au">www.brandt.id.au</a>
</footer>
    </body>
</html>
